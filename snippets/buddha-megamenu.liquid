 {% include 'buddha-megamenu-wireframe' %} <script> if (window.addEventListener) { var schemaJSON = "[{\"position\":0,\"icon\":\"\",\"name\":\"New Arrival\",\"link\":\"collection\",\"id\":\"364078915\",\"type\":\"simple\",\"items\":[{\"position\":0,\"name\":\"Women\",\"link\":\"link-list\",\"items\":[{\"position\":0,\"name\":\" Women\",\"link\":\"collection\",\"id\":\"364079171\"},{\"position\":1,\"name\":\"Heels\",\"link\":\"collection\",\"id\":\"364079299\"},{\"position\":2,\"name\":\"Flats\",\"link\":\"collection\",\"id\":\"364079363\"},{\"position\":3,\"name\":\"Boots\",\"link\":\"collection\",\"id\":\"364079555\"},{\"position\":4,\"name\":\"Sandals\",\"link\":\"collection\",\"id\":\"364079619\"},{\"position\":5,\"name\":\"Oxfords\",\"link\":\"collection\",\"id\":\"364079811\"},{\"position\":6,\"name\":\"Sneakers\",\"link\":\"collection\",\"id\":\"364079875\"}]},{\"position\":1,\"name\":\"Men\",\"link\":\"link-list\",\"items\":[{\"position\":0,\"name\":\" Men\",\"link\":\"collection\",\"id\":\"364080131\"},{\"position\":1,\"name\":\"Oxfords\",\"link\":\"collection\",\"id\":\"364080259\"},{\"position\":2,\"name\":\"Boots\",\"link\":\"collection\",\"id\":\"364080387\"},{\"position\":3,\"name\":\"Sandals\",\"link\":\"collection\",\"id\":\"364080579\"},{\"position\":4,\"name\":\"Boat Shoes\",\"link\":\"collection\",\"id\":\"364080835\"},{\"position\":5,\"name\":\"Sneaker\",\"link\":\"collection\",\"id\":\"364080963\"}]}]},{\"position\":1,\"icon\":\"\",\"name\":\"Women\",\"link\":\"collection\",\"id\":\"364100035\",\"type\":\"simple\",\"items\":[{\"position\":0,\"name\":\"Heels\",\"link\":\"link-list\",\"items\":[{\"position\":0,\"name\":\" Heels\",\"link\":\"collection\",\"id\":\"364015107\"},{\"position\":1,\"name\":\"Pumps\",\"link\":\"collection\",\"id\":\"364014211\"},{\"position\":2,\"name\":\"Sandals\",\"link\":\"collection\",\"id\":\"364014275\"},{\"position\":3,\"name\":\"Wedges\",\"link\":\"collection\",\"id\":\"364014339\"},{\"position\":4,\"name\":\"Platforms\",\"link\":\"collection\",\"id\":\"364014723\"},{\"position\":5,\"name\":\" Flats\",\"link\":\"collection\",\"id\":\"364054659\"},{\"position\":6,\"name\":\"Ballets\",\"link\":\"collection\",\"id\":\"364056323\"},{\"position\":7,\"name\":\"Sneakers\",\"link\":\"collection\",\"id\":\"364056579\"},{\"position\":8,\"name\":\"Sandals\",\"link\":\"collection\",\"id\":\"364056835\"},{\"position\":9,\"name\":\"Loafers\",\"link\":\"collection\",\"id\":\"364057027\"},{\"position\":10,\"name\":\"Moccasins & Boat Shoes\",\"link\":\"collection\",\"id\":\"364057795\"},{\"position\":11,\"name\":\"Comfort\",\"link\":\"collection\",\"id\":\"364058115\"}]},{\"position\":1,\"name\":\"Boots\",\"link\":\"link-list\",\"items\":[{\"position\":0,\"name\":\" Boots\",\"link\":\"collection\",\"id\":\"364015299\"},{\"position\":1,\"name\":\"Booties\",\"link\":\"collection\",\"id\":\"364015491\"},{\"position\":2,\"name\":\"Flats\",\"link\":\"collection\",\"id\":\"364020803\"},{\"position\":3,\"name\":\"Heels\",\"link\":\"collection\",\"id\":\"364041219\"},{\"position\":4,\"name\":\"Wedges\",\"link\":\"collection\",\"id\":\"364014339\"},{\"position\":5,\"name\":\"Rain Boots\",\"link\":\"collection\",\"id\":\"364042883\"},{\"position\":6,\"name\":\"Winter Boots\",\"link\":\"collection\",\"id\":\"364043779\"},{\"position\":7,\"name\":\" Sandals\",\"link\":\"collection\",\"id\":\"364063811\"},{\"position\":8,\"name\":\"Flats\",\"link\":\"collection\",\"id\":\"364081091\"},{\"position\":9,\"name\":\"Heels\",\"link\":\"collection\",\"id\":\"364081155\"},{\"position\":10,\"name\":\"Wedges\",\"link\":\"collection\",\"id\":\"364064067\"},{\"position\":11,\"name\":\"Platforms\",\"link\":\"collection\",\"id\":\"364074691\"},{\"position\":12,\"name\":\"Oxfords\",\"link\":\"collection\",\"id\":\"364074883\"}]},{\"position\":2,\"name\":\"Sneakers & Clothing\",\"link\":\"link-list\",\"items\":[{\"position\":0,\"name\":\" Sneakers\",\"link\":\"collection\",\"id\":\"364045507\"},{\"position\":1,\"name\":\"Chuck Taylor\",\"link\":\"collection\",\"id\":\"364045891\"},{\"position\":2,\"name\":\"Jack Purcell\",\"link\":\"collection\",\"id\":\"364049923\"},{\"position\":3,\"name\":\" Clothing\",\"link\":\"collection\",\"id\":\"364051459\"},{\"position\":4,\"name\":\"Legging & Tights\",\"link\":\"collection\",\"id\":\"364051907\"},{\"position\":5,\"name\":\"Socks\",\"link\":\"collection\",\"id\":\"364052995\"},{\"position\":6,\"name\":\"Accessories & ShoeCare\",\"link\":\"collection\",\"id\":\"364054019\"},{\"position\":7,\"name\":\" Jewelry\",\"link\":\"collection\",\"id\":\"364054595\"}]}]},{\"position\":2,\"icon\":\"\",\"name\":\"Men\",\"link\":\"collection\",\"id\":\"364100483\",\"type\":\"simple\",\"items\":[{\"position\":0,\"name\":\"Boots\",\"link\":\"link-list\",\"items\":[{\"position\":0,\"name\":\" Oxfords\",\"link\":\"collection\",\"id\":\"364075139\"},{\"position\":1,\"name\":\" Boots\",\"link\":\"collection\",\"id\":\"364075203\"},{\"position\":2,\"name\":\"Military\",\"link\":\"collection\",\"id\":\"364075395\"},{\"position\":3,\"name\":\"Western\",\"link\":\"collection\",\"id\":\"364075523\"},{\"position\":4,\"name\":\" Sandals\",\"link\":\"collection\",\"id\":\"364075587\"},{\"position\":5,\"name\":\" Boat Shoes\",\"link\":\"collection\",\"id\":\"364075971\"}]},{\"position\":1,\"name\":\"Sneakers\",\"link\":\"link-list\",\"items\":[{\"position\":0,\"name\":\" Sneakers\",\"link\":\"collection\",\"id\":\"364076035\"},{\"position\":1,\"name\":\"Chuck Taylor\",\"link\":\"collection\",\"id\":\"364076163\"},{\"position\":2,\"name\":\"Jake Purcell\",\"link\":\"collection\",\"id\":\"364076419\"},{\"position\":3,\"name\":\"Hight Tops\",\"link\":\"collection\",\"id\":\"364076483\"},{\"position\":4,\"name\":\"Canvas\",\"link\":\"collection\",\"id\":\"364076547\"},{\"position\":5,\"name\":\"Classics\",\"link\":\"collection\",\"id\":\"364076611\"},{\"position\":6,\"name\":\"Skate\",\"link\":\"collection\",\"id\":\"364076675\"}]}]},{\"position\":3,\"icon\":\"\",\"name\":\"Kids\",\"link\":\"collection\",\"id\":\"364082179\",\"type\":\"simple\",\"items\":[{\"position\":0,\"name\":\"Boys\",\"link\":\"link-list\",\"items\":[{\"position\":0,\"name\":\" Boys\",\"link\":\"collection\",\"id\":\"364082307\"}]},{\"position\":1,\"name\":\"Girls\",\"link\":\"link-list\",\"items\":[{\"position\":0,\"name\":\" Girls\",\"link\":\"collection\",\"id\":\"364082371\"}]}]},{\"position\":4,\"icon\":\"\",\"name\":\"Sale\",\"link\":\"collection\",\"id\":\"364077315\",\"type\":\"simple\",\"items\":[{\"position\":0,\"name\":\"Mens\",\"link\":\"link-list\",\"items\":[{\"position\":0,\"name\":\" Men\",\"link\":\"collection\",\"id\":\"364077443\"},{\"position\":1,\"name\":\"Oxfords\",\"link\":\"collection\",\"id\":\"364077763\"},{\"position\":2,\"name\":\"Boots\",\"link\":\"collection\",\"id\":\"364077827\"},{\"position\":3,\"name\":\"Sandals\",\"link\":\"collection\",\"id\":\"364078019\"},{\"position\":4,\"name\":\"Boat Shoes\",\"link\":\"collection\",\"id\":\"364078083\"},{\"position\":5,\"name\":\"Sneakers\",\"link\":\"collection\",\"id\":\"364078147\"}]},{\"position\":1,\"name\":\"Women\",\"link\":\"link-list\",\"items\":[{\"position\":0,\"name\":\" Women\",\"link\":\"collection\",\"id\":\"364078211\"},{\"position\":1,\"name\":\"Heels\",\"link\":\"collection\",\"id\":\"364078275\"},{\"position\":2,\"name\":\"Flats\",\"link\":\"collection\",\"id\":\"364078339\"},{\"position\":3,\"name\":\"Boots\",\"link\":\"collection\",\"id\":\"364078403\"},{\"position\":4,\"name\":\"Sandals\",\"link\":\"collection\",\"id\":\"364078467\"},{\"position\":5,\"name\":\"Sneakers\",\"link\":\"collection\",\"id\":\"364078531\"},{\"position\":6,\"name\":\"Oxford\",\"link\":\"collection\",\"id\":\"364078595\"},{\"position\":7,\"name\":\"Clothing\",\"link\":\"collection\",\"id\":\"364078787\"}]}]}]", schemaLinksJSON = '{"collection":{"364078915":"\/collections\/new-arrival","364079171":"\/collections\/women-2","364079299":"\/collections\/heels-2","364079363":"\/collections\/flats-2","364079555":"\/collections\/boots-1","364079619":"\/collections\/sandals-2","364079811":"\/collections\/oxfords-2","364079875":"\/collections\/sneakers-2","364080131":"\/collections\/men-1","364080259":"\/collections\/oxfords-3","364080387":"\/collections\/boots-2","364080579":"\/collections\/sandals-3","364080835":"\/collections\/boat-shoes-2","364080963":"\/collections\/sneaker","364100035":"\/collections\/women-3","364015107":"\/collections\/heels","364014211":"\/collections\/pumps","364014275":"\/collections\/sandals-for-women","364014339":"\/collections\/wedges","364014723":"\/collections\/platforms","364054659":"\/collections\/flats","364056323":"\/collections\/balletsflats","364056579":"\/collections\/sneakers-for-womenflats","364056835":"\/collections\/sandals-for-womenflats","364057027":"\/collections\/loafers","364057795":"\/collections\/moccasins-boat-shoes","364058115":"\/collections\/comfort","364015299":"\/collections\/boots-for-women","364015491":"\/collections\/bootiesboots","364020803":"\/collections\/flatsboots","364041219":"\/collections\/heelsboots","364042883":"\/collections\/rain-boots","364043779":"\/collections\/winter-boots","364063811":"\/collections\/sandals-for-women-1","364081091":"\/collections\/flats-3","364081155":"\/collections\/heels-3","364064067":"\/collections\/wedgessandals","364074691":"\/collections\/platformssandals","364074883":"\/collections\/oxfords-for-women","364045507":"\/collections\/sneakers-for-women","364045891":"\/collections\/chuck-taylor-for-womensneakers","364049923":"\/collections\/jack-purcell-for-womensneakers","364051459":"\/collections\/clothing-for-women","364051907":"\/collections\/legging-tights-for-womenclothing","364052995":"\/collections\/socks","364054019":"\/collections\/accessories-shoecare","364054595":"\/collections\/jewelry","364100483":"\/collections\/men-2","364075139":"\/collections\/oxfords-for-men","364075203":"\/collections\/boots-for-men","364075395":"\/collections\/military","364075523":"\/collections\/western","364075587":"\/collections\/sandals-for-men","364075971":"\/collections\/boat-shoes","364076035":"\/collections\/sneakers-for-men","364076163":"\/collections\/chuck-taylor-for-men","364076419":"\/collections\/jake-purcell","364076483":"\/collections\/high-tops","364076547":"\/collections\/canvas","364076611":"\/collections\/classics","364076675":"\/collections\/skate","364082179":"\/collections\/kids","364082307":"\/collections\/boys","364082371":"\/collections\/girls","364077315":"\/collections\/sale","364077443":"\/collections\/men","364077763":"\/collections\/oxfords","364077827":"\/collections\/boots","364078019":"\/collections\/sandals","364078083":"\/collections\/boat-shoes-1","364078147":"\/collections\/sneakers","364078211":"\/collections\/women-1","364078275":"\/collections\/heels-1","364078339":"\/collections\/flats-1","364078403":"\/collections\/boats","364078467":"\/collections\/sandals-1","364078531":"\/collections\/sneakers-1","364078595":"\/collections\/oxfords-1","364078787":"\/collections\/clothing"}}', schemaDesignJSON = '[{"action":"menu-select","value":"main-menu"},{"action":"design","setting":"button_background_hover_color","value":"#0d8781"},{"action":"design","setting":"link_hover_color","value":"#0da19a"},{"action":"design","setting":"button_background_color","value":"#0da19a"},{"action":"design","setting":"link_color","value":"#4e4e4e"},{"action":"design","setting":"background_hover_color","value":"#f9f9f9"},{"action":"design","setting":"background_color","value":"#ffffff"},{"action":"design","setting":"button_text_hover_color","value":"#ffffff"},{"action":"design","setting":"button_text_color","value":"#ffffff"},{"action":"design","setting":"font_size","value":"13px"},{"action":"design","setting":"text_color","value":"#222222"},{"action":"design","setting":"vertical_text_color","value":"#4e4e4e"},{"action":"design","setting":"vertical_link_color","value":"#4e4e4e"},{"action":"design","setting":"vertical_link_hover_color","value":"#0da19a"},{"action":"design","setting":"vertical_font_size","value":"13px"}]', undo = [], redo = [], action = "", tempMenuObject = {}, originalBindings = {}, initRunning = false, changedMenu = false, submenuToggled = false, changingPage = false, saving = false, prices = [], productImages = [], panelOpened = false, verticalMenuMaxWidth = 10000, selectedMenu, clicked, touched, burgerIcon, disableOnClick = false, globalTouch = true, onClickOnlyReinit = false, disableOnScroll = false, firstInitMilliseconds = 350, ulPaths = [], customHeaderOffset = false, fontSize = 0; /* set product prices */ {% for product in collections["mega-menu-featured-products"].products %} prices[{{ product.id }}] = '{% if product.available %}{% if product.compare_at_price > product.price %}<span class="mega-menu-compare_at_price">{{ product.compare_at_price | money }}</span> {% endif %}<span class="mega-menu-price">{{ product.price | money }}</span>{% else %}<span class="mega-menu-sold_out">Sold out</span>{% endif %}'; productImages[{{ product.id }}] = '{{ product.featured_image | product_img_url: "240x" }}'; {% endfor %} /* get the collection images */ var collectionImages = []; /* INITIALIZE MENU FUNCTIONS */ jQuery(document).ready(function(){ /* check it mega menu app is installed */ var installed = false; jQuery("script").each(function(){ if (jQuery(this).text().indexOf("mm-init.js?")!=-1 && jQuery(this).text().indexOf("asyncLoad")!=-1 && jQuery(this).text().indexOf("initSchema")==-1) { installed = true; } }); if (jQuery("head").html().indexOf("assets\/mm-init.js?")!=-1 || installed) { var iterations = 0; /* bundle app by smar7 apps fix */ var bundleAppMutations = setInterval(function(){ iterations++; if (typeof mutationExceptions !== "undefined") { mutationExceptions[mutationExceptions.length] = ".buddha-menu-item"; clearInterval(bundleAppMutations); } if (iterations>10) { clearInterval(bundleAppMutations); } },1000); burgerIcon = ".js-mobile-nav-toggle"; disableOnClick = true; initSchema(); /* remove shopify fixed top bar (keep verifying in case you navigate with mobile view, then resize) */ if (window.self!==window.top) { jQuery("#admin_bar_iframe").remove(); jQuery("html").css("padding-top","0px"); setInterval(function(){ jQuery("*").each(function(){ if (jQuery(this).css("top")=="40px" && jQuery(this).css("position")=="fixed") { jQuery(this).css("top","0"); } }); },1000); } var reinitTimeout; var windowWidth = jQuery(window).width(); jQuery(window).resize(function(){ if (windowWidth!=jQuery(window).width()) { jQuery(".hovering").removeClass("hovering"); jQuery(".submenu-opened").hide().removeClass("submenu-opened"); jQuery(".fa-minus-circle").removeClass("fa-minus-circle").addClass("fa-plus-circle"); clearTimeout(reinitTimeout); reinitTimeout = setTimeout(function(){ applyMegaMenu(); applyOnClick(); windowWidth=jQuery(window).width(); },300); } }); if (!disableOnScroll) { /* DEPRECATED var reinitScrollTimeout; jQuery(window).scroll(function(){ clearTimeout(reinitScrollTimeout); reinitScrollTimeout = setTimeout(function(){ var submenuVisible = false; jQuery(".horizontal-mega-menu>.buddha-menu-item>.mm-submenu").each(function(){ if (parseInt(jQuery(this).css("top"))>0) { setSubmenuBoundries(jQuery(this).parent()); } }); },10); }); */ /* if static main menu, add overflow */ var reinitScrollTimeout; setInterval(function(){ jQuery(".horizontal-mega-menu>.buddha-menu-item>.mm-submenu").each(function(){ if (parseInt(jQuery(this).css("top"))>0) { var li = jQuery(this).parent(); if (li.find(">ul.mm-submenu.simple").length>0 || li.find(">ul.mm-submenu.tabbed").length>0) { var hasPositionStatic = false; li.parent().parents().each(function(){ if (jQuery(this).css("position")=="fixed") { hasPositionStatic = true; } }); if (li.find(">ul.mm-submenu.simple").length>0) { var submenu = li.find(">ul.mm-submenu.simple"); } else { var submenu = li.find(">ul.mm-submenu.tabbed"); } if (hasPositionStatic) { var maxHeight = jQuery(window).height()-100; if ((jQuery(window).height()-50)<submenu.height()) { submenu.css({"max-height":maxHeight+"px","overflow":"scroll","overflow-x":"hidden"}); } /* in case there is little content on a page and the main menu is fixed */ } else if ((jQuery(document).height()-200)<=jQuery(window).height()) { var maxHeight = jQuery(document).height()-250; submenu.css({"max-height":maxHeight+"px","overflow":"scroll","overflow-x":"hidden"}); } else { submenu.css({"max-height":"none","overflow":"hidden"}); } } } }); },1000); } setTimeout(function(){ applyMegaMenu(); /* when a certain element is clicked, reinit the menus and reset the simple submenu width, in case the side menu is hidden */ applyOnClick(); },firstInitMilliseconds); } else if (typeof beforeMegaMenuInterval!=="undefined") { jQuery(".buddha-disabled-menu").removeClass("buddha-disabled-menu"); jQuery(".buddha-mm-style").remove(); clearInterval(beforeMegaMenuInterval); } else { jQuery(".buddha-disabled-menu").removeClass("buddha-disabled-menu"); jQuery(".buddha-mm-style").remove(); } }); /* when a certain element is clicked, reinit the menus and reset the simple submenu width, in case the side menu is hidden */ function applyOnClick() { if (!disableOnClick) { clicked = false; if (jQuery(burgerIcon).length==0) { burgerIcon = false; } jQuery(burgerIcon || "*").unbind("click.apply-mm"); jQuery(burgerIcon || "*").bind("click.apply-mm", function(){ var element = jQuery(this); if (!clicked && !touched) { clicked = true; setTimeout(function(){ if (!changingPage && element.closest(".buddha-menu-item").length==0 && !element.hasClass("vertical-mega-menu") && !element.hasClass("horizontal-mega-menu")) { if (onClickOnlyReinit) { jQuery.each(ulPaths,function(index,value){ reinitMenus(value); }); } else { applyMegaMenu(); } } },350); } setTimeout(function(){ clicked = false; },400); }); } } function initSchema() { schemaJSON = JSON.parse(schemaJSON); schemaLinksJSON = JSON.parse(schemaLinksJSON); schemaDesignJSON = JSON.parse(schemaDesignJSON); initRunning = true; /* apply custom design */ recreateDesign(); action = ""; initRunning = false; parent.postMessage(["updateToolbar",JSON.stringify(schemaDesignJSON),JSON.stringify(linkLists),JSON.stringify(undo),JSON.stringify(redo),changedMenu], "*" ); } function applyMegaMenu(menu) { /* bundle app by smar7 apps fix */ if (typeof mutationExceptions !== "undefined") { mutationExceptions[mutationExceptions.length] = "ul"; } if (typeof beforeMegaMenuInterval!=="undefined") { clearInterval(beforeMegaMenuInterval); } if (menu!=undefined) { var newSchemaDesign = []; selectedMenu = menu; jQuery.each(schemaDesignJSON,function(key, item){ if (item.action!="menu-select") { newSchemaDesign.push(item); } }); schemaDesignJSON = newSchemaDesign; changedMenu = true; } else { jQuery.each(schemaDesignJSON,function(key, item){ if (item.action=="menu-select") { selectedMenu = item.value; } }); } jQuery(".vertical-mega-menu").removeClass("vertical-mega-menu"); jQuery(".horizontal-mega-menu").removeClass("horizontal-mega-menu"); jQuery(".buddha-disabled").removeClass("buddha-disabled"); jQuery(".buddha-menu-item").remove(); jQuery("#themeScript").remove(); var links = []; jQuery.each(linkLists,function(key, item){ if (selectedMenu==key) { links = item.items; return false; } }); console.log(links); if (selectedMenu!=undefined && selectedMenu!="none" && links.length>0) { jQuery("ul,nav").each(function(){ var forceMenu = false; var elementFits = 0; var skipCheck = false; tempMenuObject = {}; tempMenuObject.ul = jQuery(this); if (!skipCheck) { jQuery(this).children("li").each(function(){ var li = jQuery(this); var a = li.find("a").first(); var href = a.attr("href"); if ((href==undefined || (href!=undefined && (href.substr(0,1)=="#" || href==""))) && li.find("a:nth-child(2)").length>0) { a = li.find("a:nth-child(2)"); href = a.attr("href"); } else if ((href==undefined || (href!=undefined && (href.substr(0,1)=="#" || href==""))) && li.find("a>a").length>0) { a = li.find("a>a"); href = a.attr("href"); } if (links[elementFits]!=undefined && href==links[elementFits]) { if (tempMenuObject.liClasses==undefined) { tempMenuObject.liClasses = ""; } tempMenuObject.liClasses = concatClasses(li.attr("class"),tempMenuObject.liClasses); if (tempMenuObject.aClasses==undefined) { tempMenuObject.aClasses = []; } tempMenuObject.aClasses = concatClasses(a.attr("class"),tempMenuObject.aClasses); if (tempMenuObject.liItems==undefined) { tempMenuObject.liItems = []; } if (jQuery.inArray(li,tempMenuObject.liItems)==-1) { tempMenuObject.liItems[tempMenuObject.liItems.length] = li; } li.addClass("buddha-transparent"); elementFits++; } else if (elementFits>0 && elementFits!=links.length) { elementFits = 0; tempMenuObject.liItems = []; jQuery(".buddha-transparent").removeClass("buddha-transparent"); if (href==links[0]) { elementFits = 1; tempMenuObject.liItems[tempMenuObject.liItems.length] = li; li.addClass("buddha-transparent"); } } }); } if ((elementFits>0 && elementFits==links.length) || forceMenu) { var liClasses = getSpecificClasses(tempMenuObject.liClasses); var aClasses = getSpecificClasses(tempMenuObject.aClasses); jQuery.each(tempMenuObject.liItems, function(key, item) { jQuery(item).removeClass("buddha-transparent").addClass("buddha-disabled"); }); jQuery.each(schemaJSON.reverse(), function(key, item) { var firstLi = tempMenuObject.ul.find(">li").first(); if (firstLi.find("a").length==0 && firstLi.next().find("a").length>0) { var clone = firstLi.next().clone(); } else { var clone = firstLi.clone(); } var insertedClone = clone.prependTo(tempMenuObject.ul).removeAttr("class").addClass("buddha-menu-item "+liClasses["common"]); if (item.link=="no-link") { var dataHref = "no-link"; var href = "#"; } else if (item.link=="http") { var dataHref = item.http; var href = item.http; } else { var dataHref = (item.id!=undefined && schemaLinksJSON[item.link]!=undefined && schemaLinksJSON[item.link][item.id]!=undefined) ? schemaLinksJSON[item.link][item.id] : schemaLinksJSON[item.link]; var href = (item.id!=undefined && schemaLinksJSON[item.link]!=undefined && schemaLinksJSON[item.link][item.id]!=undefined) ? schemaLinksJSON[item.link][item.id] : schemaLinksJSON[item.link]; } var icon = ""; if (item.icon!=undefined && item.icon!="" && item.icon!="none") { icon = "<i class=\"fa fa-"+item.icon+"\" aria-hidden=\"true\"></i> "; } var aContent = icon+item.name; if (insertedClone.find("a").first().find(">:first-child").length>0 && insertedClone.find("a").first().find(">:first-child").prop("tagName").toLowerCase()=="span" && insertedClone.find("a").first().find("span").first().text().trim()==insertedClone.find("a").first().text().trim()) { var spanClass = insertedClone.find("a").first().find(">:first-child").attr("class"); if (spanClass!="undefined") { aContent = "<span class=\""+spanClass+"\">"+aContent+"</span>"; } else { aContent = "<span>"+aContent+"</span>"; } } var useOnClick = ""; if (window.self===window.top || (window.self!==window.top && window.name=="mega-menu-iframe")) { useOnClick = "onclick=\"return mmGoToPage(this)\""; } var aHtml = "<a class=\""+aClasses["common"]+"\" href=\""+href+"\" data-href=\""+dataHref+"\" "+useOnClick+" title=\""+item.name+"\">"+aContent+"</a>"; var submenuHtml = addSubMenus(item); insertedClone.html(aHtml+submenuHtml); if (item.type=="contact") { jQuery("#mm-contact").clone().appendTo(insertedClone).show().removeAttr("id"); } }); /* add arrow to main menu items that have submenus */ tempMenuObject.ul.find(">li").each(function(){ if (jQuery(this).find("ul.mm-submenu").length>0) { if (jQuery(this).find(">a>span").length>0) { jQuery(this).find(">a>span").append("&nbsp;<i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i>"); } else { jQuery(this).find(">a").append("&nbsp;<i class=\"fa fa-angle-down\" aria-hidden=\"true\"></i>"); } } }); /* add toggle submenu button for vertical menu */ tempMenuObject.ul.find(" ul.mm-submenu").each(function(){ if (jQuery(this).parent().find(">a>span").length>0) { jQuery(this).parent().find(">a>span").append(" <button class=\"toggle-menu-btn\" style=\"display:none;\" onclick=\"return toggleSubmenu(this)\"><i class=\"fa fa-plus-circle\" aria-hidden=\"true\"></i></button>"); } else { jQuery(this).parent().find(">a").append(" <button class=\"toggle-menu-btn\" style=\"display:none;\" onclick=\"return toggleSubmenu(this)\"><i class=\"fa fa-plus-circle\" aria-hidden=\"true\"></i></button>"); } }); schemaJSON.reverse(); if (liClasses["first"] || aClasses["first"] || liClasses["last"] || aClasses["last"]) { tempMenuObject.ul.find(".buddha-menu-item").first().addClass(liClasses["first"]); tempMenuObject.ul.find(".buddha-menu-item").last().addClass(liClasses["last"]); tempMenuObject.ul.find(".buddha-menu-item").first().find("a").first().addClass(aClasses["first"]); tempMenuObject.ul.find(".buddha-menu-item").last().find("a").first().addClass(aClasses["last"]); } /* set menu item as active */ if (liClasses["active"] || aClasses["active"]) { tempMenuObject.ul.find(">.buddha-menu-item").each(function() { var a = jQuery(this).find("a").first(); if (a.attr("data-href")==window.location.pathname) { a.addClass(aClasses["active"]); jQuery(this).addClass(liClasses["active"]); } }); } tempMenuObject = {}; /* add theme specific scripts if mega menu added */ jQuery("head").append("<style id=\"themeScript\"> .mobile-nav-wrapper { overflow:visible; z-index:1; } .site-header { z-index:3; } </style>"); clicked = false; /* original menu shows slow and needs bigger delay to apply mega menu */ jQuery(".js-mobile-nav-toggle").on("click", function(){ if (!clicked) { clicked = true; setTimeout(function(){ jQuery(".hovering").removeClass("hovering"); jQuery(".submenu-opened").hide().removeClass("submenu-opened"); jQuery(".fa-minus-circle").removeClass("fa-minus-circle").addClass("fa-plus-circle"); applyMegaMenu(); },500); } setTimeout(function(){ clicked = false; },600); }); var ulPath = getUlPath(jQuery(this)); var isSubmenuOfPreviousUlPath = false; if (jQuery.inArray(ulPath,ulPaths)==-1 && !jQuery(this).hasClass("buddha-hidden-wireframe") && ulPath.indexOf(".buddha-hidden-wireframe")==-1) { jQuery.each(ulPaths,function(index,value){ if (ulPath.indexOf(value)!==-1) { isSubmenuOfPreviousUlPath = true; } }); if (!isSubmenuOfPreviousUlPath) { ulPaths[ulPaths.length] = ulPath; } } } else { jQuery(".buddha-transparent").removeClass("buddha-transparent"); } }); jQuery(".buddha-disabled-menu").removeClass("buddha-disabled-menu"); if (window.self!==window.top) { parent.postMessage(["updateToolbar",JSON.stringify(schemaDesignJSON),JSON.stringify(linkLists),JSON.stringify(undo),JSON.stringify(redo),changedMenu], "*" ); } jQuery.each(ulPaths,function(index,value){ reinitMenus(value); }); } /* bundle app by smar7 apps fix */ setTimeout(function(){ if (typeof mutationExceptions !== "undefined") { mutationExceptions.pop(); } },100); } /* determines if menu should be vertical or horizontal */ function reinitMenus(ulPath) { /* if(!jQuery(ulPath).is(":visible") && (typeof jQuery(ulPath).attr("style")===typeof undefined || jQuery(ulPath).attr("style").replace(/ /g, "").indexOf("display:none")==-1 || (jQuery(ulPath).attr("style").replace(/ /g, "").indexOf("display:none")!=-1 && jQuery(ulPath).css("display")=="none"))) { return; } */ jQuery(".submenu-opened").hide(); var previousItemTop; /* var horizontal = true; */ var verticalItemsNr = 1; jQuery(ulPath+">.buddha-menu-item").each(function() { previousItemTop = (previousItemTop==undefined) ? jQuery(this).position().top : previousItemTop; if (previousItemTop!=jQuery(this).position().top && (previousItemTop+1)!=jQuery(this).position().top && (previousItemTop+2)!=jQuery(this).position().top && (previousItemTop-1)!=jQuery(this).position().top && (previousItemTop-2)!=jQuery(this).position().top) { /* horizontal = false; */ verticalItemsNr++; } previousItemTop = jQuery(this).position().top; }); if (verticalItemsNr!=jQuery(ulPath+">.buddha-menu-item").length || (verticalItemsNr==1 && jQuery("body").width()>verticalMenuMaxWidth)) { jQuery(ulPath).addClass("horizontal-mega-menu").removeClass("vertical-mega-menu"); jQuery(ulPath+" ul.mm-submenu").removeAttr("style"); jQuery(ulPath+" .fa-minus-circle").removeClass("fa-minus-circle").addClass("fa-plus-circle"); jQuery(ulPath+" .submenu-opened").removeClass("submenu-opened"); jQuery(ulPath+" .toggle-menu-btn").hide(); jQuery(".horizontal-mega-menu>li.buddha-menu-item").off(); jQuery(ulPath).find(".buddha-menu-item").each(function(){ setSubmenuBoundries(jQuery(this)); setContactSubmenuBoundries(jQuery(this)); }); jQuery(ulPath).find("ul.mm-submenu.tabbed>li").each(function(){ if (jQuery(this).parent().find(".tab-opened").length==0) { /* jQuery(this).parent().find(".tab-opened").removeClass("tab-opened"); */ jQuery(this).addClass("tab-opened"); setTabbedSubmenuBoundries(jQuery(this)); } else if (jQuery(this).hasClass("tab-opened")) { setTabbedSubmenuBoundries(jQuery(this)); } }); jQuery(ulPath).find("ul.mm-submenu.tabbed>li").unbind(); jQuery(ulPath).find("ul.mm-submenu.tabbed>li").hover(function(){ jQuery(this).parent().find(".tab-opened").removeClass("tab-opened"); jQuery(this).addClass("tab-opened"); setTabbedSubmenuBoundries(jQuery(this)); }); /* set first tab of every tabbed submenu be opened */ jQuery(ulPath).find("ul.mm-submenu.tabbed>li:first-child").each(function(){ if (jQuery(this).parent().find(".tab-opened").length==0) { jQuery(this).addClass("tab-opened"); setTabbedSubmenuBoundries(jQuery(this)); } }); jQuery(ulPath).find(".buddha-menu-item").unbind("mouseenter.resizeSubmenus"); jQuery(ulPath).find(".buddha-menu-item").bind("mouseenter.resizeSubmenus",function(){ setSubmenuBoundries(jQuery(this)); setContactSubmenuBoundries(jQuery(this)); if (jQuery(this).find(".tab-opened").length>0) { setTabbedSubmenuBoundries(jQuery(this).find(".tab-opened")); } }); } else { jQuery(".mega-hover").removeClass("mega-hover"); jQuery(".disabled").removeClass("disabled"); jQuery(ulPath).addClass("vertical-mega-menu").removeClass("horizontal-mega-menu"); jQuery(ulPath+" .toggle-menu-btn").show(); jQuery(ulPath).find("li.buddha-menu-item").off(); jQuery(ulPath).find("li.buddha-menu-item a").off(); var iconDistance = parseInt(jQuery(ulPath+">li>a").css("font-size")); var totalPaddingLeft = parseInt(jQuery(ulPath+">li").css("padding-left"))+parseInt(jQuery(ulPath+">li>a").css("padding-left")); var paddingLeftSubSubmenus = totalPaddingLeft; if (totalPaddingLeft>15) { paddingLeftSubSubmenus = 15; } var totalPaddingTop = parseInt(jQuery(ulPath+">li").css("padding-top"))+parseInt(jQuery(ulPath+">li>a").css("padding-top")); jQuery("#verticalMenuSpacing").remove(); var styleSheet = '<style id="verticalMenuSpacing" type="text/css">'; /* styleSheet += ulPath+'.vertical-mega-menu>li>ul.mm-submenu{margin-left:'+iconDistance+'px !important;margin-right:'+iconDistance+'px !important}'; */ /* styleSheet += ulPath+'.vertical-mega-menu>li>ul.mm-submenu>li:first-child{margin-top:-'+totalPaddingTop+'px !important}'; */ /* styleSheet += ulPath+'.vertical-mega-menu>li>ul.mm-submenu>li:last-child{margin-bottom:'+totalPaddingTop+'px !important}'; */ styleSheet += ulPath+'.vertical-mega-menu>li>ul.mm-submenu.tree>li{padding-left:'+totalPaddingLeft+'px !important;padding-right:'+totalPaddingLeft+'px !important;}'; styleSheet += ulPath+'.vertical-mega-menu>li>ul.mm-submenu.tree>li ul.mm-submenu li {padding-left:'+paddingLeftSubSubmenus+'px !important;padding-right:'+paddingLeftSubSubmenus+'px !important;}'; styleSheet += ulPath+'.vertical-mega-menu>li ul.mm-submenu.simple>li{padding-left:'+totalPaddingLeft+'px !important;padding-right:'+totalPaddingLeft+'px !important;}'; styleSheet += ulPath+'.vertical-mega-menu>li>ul.mm-submenu.tabbed>li{padding-left:'+totalPaddingLeft+'px !important;padding-right:'+totalPaddingLeft+'px !important;}'; styleSheet += ulPath+'.vertical-mega-menu>li>ul.mm-submenu.tabbed>li>ul.mm-submenu>li {padding-left:'+paddingLeftSubSubmenus+'px !important;padding-right:'+paddingLeftSubSubmenus+'px !important;}'; styleSheet += ulPath+'.vertical-mega-menu>li ul.mm-submenu.mm-contact>li{padding-left:'+totalPaddingLeft+'px !important;padding-right:'+totalPaddingLeft+'px !important;}'; /* styleSheet += ulPath+'.vertical-mega-menu>li ul.mm-submenu.simple li{padding-left:0px !important;padding-right:0px !important}'; */ styleSheet += "</style>"; jQuery("head").append(styleSheet); /*jQuery(ulPath+">li>ul.mm-submenu").css({"margin-top":-totalPaddingTop+"px","margin-bottom":totalPaddingTop+"px","margin-left":iconDistance+"px"}); jQuery(ulPath+">li ul.mm-submenu li").css({"padding-left":totalPaddingLeft+"px","padding-top":totalPaddingTop+"px"});*/ /* remove tab-opened classes */ jQuery(ulPath).find(".tab-opened").removeClass("tab-opened"); jQuery(ulPath).find(".buddha-menu-item>a>.toggle-menu-btn").unbind("click.resizeSubmenus"); jQuery(ulPath).find(".buddha-menu-item>a>.toggle-menu-btn").bind("click.resizeSubmenus",function(){ setSubmenuBoundries(jQuery(this).parent().parent()); setContactSubmenuBoundries(jQuery(this).parent().parent()); }); jQuery(ulPath).find(".buddha-menu-item>.mm-submenu>li>a>.toggle-menu-btn").unbind("click.resizeTabbedSubmenu"); jQuery(ulPath).find(".buddha-menu-item>.mm-submenu>li>a>.toggle-menu-btn").bind("click.resizeTabbedSubmenu",function(){ if (jQuery(this).parent().parent().hasClass("hovering")) { setTabbedSubmenuBoundries(jQuery(this).parent().parent()); } }); } jQuery(".submenu-opened").show(); addTouch(); if (panelOpened) { jQuery(".horizontal-mega-menu>.buddha-menu-item").unbind("mouseenter.addMegaHoverClass"); jQuery(".horizontal-mega-menu>.buddha-menu-item").bind("mouseenter.addMegaHoverClass",function(){ jQuery(".mega-hover").removeClass("mega-hover"); if (panelOpened) { jQuery(this).addClass("mega-hover"); } }); } else { jQuery(".mega-hover").removeClass("mega-hover"); } /* ORIGINAL DEPRECATED jQuery(".buddha-menu-item").each(function(){ setSubmenuBoundries(jQuery(this)); setContactSubmenuBoundries(jQuery(this)); }); jQuery("ul.mm-submenu.tabbed>li").each(function(){ if (jQuery(this).parent().find(".tab-opened").length==0) { jQuery(this).parent().find(".tab-opened").removeClass("tab-opened"); jQuery(this).addClass("tab-opened"); setTabbedSubmenuBoundries(jQuery(this)); } else if (jQuery(this).hasClass("tab-opened")) { setTabbedSubmenuBoundries(jQuery(this)); } }); jQuery("ul.mm-submenu.tabbed>li").unbind(); jQuery("ul.mm-submenu.tabbed>li").hover(function(){ jQuery(this).parent().find(".tab-opened").removeClass("tab-opened"); jQuery(this).addClass("tab-opened"); setTabbedSubmenuBoundries(jQuery(this)); }); jQuery("ul.mm-submenu.tabbed>li:first-child").each(function(){ if (jQuery(this).parent().find(".tab-opened").length==0) { jQuery(this).addClass("tab-opened"); setTabbedSubmenuBoundries(jQuery(this)); } }); addTouch(); if (panelOpened) { jQuery(".horizontal-mega-menu>.buddha-menu-item").hover(function(){ jQuery(".mega-hover").removeClass("mega-hover"); if (panelOpened) { jQuery(this).addClass("mega-hover"); } }); } else { jQuery(".mega-hover").removeClass("mega-hover"); } jQuery(".horizontal-mega-menu>.buddha-menu-item").hover(function(){ setSubmenuBoundries(jQuery(this)); setContactSubmenuBoundries(jQuery(this)); if (jQuery(this).find(".tab-opened").length>0) { setTabbedSubmenuBoundries(jQuery(this).find(".tab-opened")); } }); */ } /* GENERATE MENU FUNCTIONS */ function concatClasses(newClasses, oldClasses) { if (oldClasses!="") { classes = oldClasses.split(" "); } else { classes = []; } if (newClasses!=undefined && newClasses!="") { newClasses = newClasses.split(" "); jQuery.each(newClasses, function(key, item) { if (jQuery.inArray(item,classes)==-1) { classes[classes.length] = item; } }); } return classes.join(" "); } function getSpecificClasses(classes) { var specificClasses = []; if (classes!=undefined) { classes = classes.split(" "); var commonClasses = ""; jQuery.each(classes, function(key, item) { if (item.indexOf("active")!=-1 || item.indexOf("selected")!=-1 || item.indexOf("current")!=-1) { specificClasses["active"] = item; } else if (item.indexOf("focus")!=-1) { specificClasses["focus"] = item; } else if (item.indexOf("first")!=-1) { specificClasses["first"] = item; } else if (item.indexOf("last")!=-1) { specificClasses["last"] = item; } else if (item.indexOf("buddha")==-1 && item.indexOf("dropdown")==-1 && item.indexOf("mm-subopen")==-1 && item.indexOf("hidden")==-1 && item.indexOf("hide")==-1) { commonClasses += " "+item; } }); specificClasses["common"] = commonClasses.trim(); } return specificClasses; } /* used to generate submenus */ function addSubMenus(parentItem,isSubTree) { var submenuHtml = ""; if (parentItem.items!=undefined && parentItem.items.length>0) { var subMenuType = (parentItem.type!=undefined) ? " "+parentItem.type : ""; submenuHtml += "<ul class=\"mm-submenu"+subMenuType+"\">"; jQuery.each(parentItem.items,function(pos,subitem){ if (subitem.link=="no-link") { var dataHref = "no-link"; var href = "#"; } else if (subitem.link=="http") { var dataHref = subitem.http; var href = subitem.http; } else { var dataHref = (subitem.id!=undefined && schemaLinksJSON[subitem.link] && schemaLinksJSON[subitem.link][subitem.id]) ? schemaLinksJSON[subitem.link][subitem.id] : schemaLinksJSON[subitem.link]; var href = (subitem.id!=undefined && schemaLinksJSON[subitem.link] && schemaLinksJSON[subitem.link][subitem.id]) ? schemaLinksJSON[subitem.link][subitem.id] : schemaLinksJSON[subitem.link]; } var useOnClick = ""; if (window.self==window.top || (window.self!==window.top && window.name=="mega-menu-iframe")) { useOnClick = "onclick=\"return mmGoToPage(this)\""; } if (parentItem.type=="simple") { if (subitem.link=="best-sellers") { submenuHtml += "<li><div class=\"mega-menu-item-container\"><div class=\"mm-list-name\"><span>"+subitem.name.replace(/&quot;/g, '"')+"</span></div></div>"; } else if (subitem.link=="newest-products") { submenuHtml += "<li><div class=\"mega-menu-item-container\"><div class=\"mm-list-name\"><span>"+subitem.name.replace(/&quot;/g, '"')+"</span></div></div>"; } else if (subitem.link=="link-list") { subitem.type = "link-list"; var linkList = addSubMenus(subitem); submenuHtml += "<li><div class=\"mega-menu-item-container\"><div class=\"mm-list-name\"><span>"+subitem.name.replace(/&quot;/g, '"')+"</span></div>"+linkList+"</div>"; } else { var image = ""; if (subitem.link=="product" && productImages[subitem.id]!=undefined && productImages[subitem.id].indexOf("no-image")==-1) { image = "<div class=\"mm-image-container\"><div class=\"mm-image\"><a data-href=\""+dataHref+"\" href=\""+href+"\" "+useOnClick+" title=\""+subitem.name.replace(/&quot;/g, '"')+"\"><img src=\""+productImages[subitem.id]+"\"></a></div></div>"; } else if (subitem.link=="collection" && collectionImages[subitem.id]!=undefined && collectionImages[subitem.id].indexOf("no-image")==-1) { image = "<div class=\"mm-image-container\"><div class=\"mm-image\"><a data-href=\""+dataHref+"\" href=\""+href+"\" "+useOnClick+" title=\""+subitem.name.replace(/&quot;/g, '"')+"\"><img src=\""+collectionImages[subitem.id]+"\"></a></div></div>"; } else if (subitem.image!=undefined) { image = "<div class=\"mm-image-container\"><div class=\"mm-image\"><a data-href=\""+dataHref+"\" href=\""+href+"\" "+useOnClick+" title=\""+subitem.name.replace(/&quot;/g, '"')+"\"><img src=\""+subitem.image+"\"></a></div></div>"; } var pricesHTML = ""; if (subitem.link=="product" && subitem.id!=undefined && prices[subitem.id]!=undefined) { pricesHTML = "<div class=\"mega-menu-prices\">"+prices[subitem.id]+"</div>"; } var nameHtml = ""; if (jQuery.trim(subitem.name)!="") { nameHtml += "<a class=\"mm-featured-title\" data-href=\""+dataHref+"\" href=\""+href+"\" "+useOnClick+" title=\""+subitem.name.replace(/&quot;/g, '"')+"\">"+subitem.name.replace(/&quot;/g, '"')+"</a>"; } submenuHtml += "<li><div class=\"mega-menu-item-container\">"+image+nameHtml+pricesHTML+"</div>"; } } else if (parentItem.type=="tree" || isSubTree) { submenuHtml += "<li data-href=\""+dataHref+"\" "+useOnClick+"><a data-href=\""+dataHref+"\" href=\""+href+"\" "+useOnClick+" title=\""+subitem.name.replace(/&quot;/g, '"')+"\">"+subitem.name.replace(/&quot;/g, '"')+"</a>"; } else { submenuHtml += "<li><a data-href=\""+dataHref+"\" href=\""+href+"\" "+useOnClick+" title=\""+subitem.name.replace(/&quot;/g, '"')+"\">"+subitem.name.replace(/&quot;/g, '"')+"</a>"; } /* set the simple menu type for each tab child */ if (parentItem.type=="tabbed") { subitem.type = "simple"; } if (subitem.link!="link-list") { if (parentItem.type=="tree" || isSubTree) { submenuHtml += addSubMenus(subitem,true); } else { submenuHtml += addSubMenus(subitem,false); } } submenuHtml += "</li>"; }); submenuHtml += "</ul>"; } return submenuHtml; } /* TOOLTIP FUNCTIONS */ function undoAction(){ if (window.self!==window.top) { currentUndo = undo[undo.length-1]; if (currentUndo.action=="design") { redo.unshift(currentUndo); schemaDesignJSON.splice(-1,1); undo.splice(-1,1); recreateDesign(); } reinitMenus(); /* if no mega menu present, remove theme scripts */ if (jQuery(".buddha-menu-item").length==0) { jQuery("#themeScript").remove(); } parent.postMessage(["updateToolbar",JSON.stringify(schemaDesignJSON),JSON.stringify(linkLists),JSON.stringify(undo),JSON.stringify(redo),changedMenu], "*" ); } } function redoAction(){ if (window.self!==window.top) { tempMenuObject = {}; jQuery(".buddha-transparent").removeClass("buddha-transparent"); action = redo[0].action; if (action=="design") { schemaDesignJSON.push(redo[0]); undo.push(redo[0]); recreateDesign(); } redo.splice(0,1); reinitMenus(); /* if no mega menu present, remove theme scripts */ if (jQuery(".buddha-menu-item").length==0) { jQuery("#themeScript").remove(); } parent.postMessage(["updateToolbar",JSON.stringify(schemaDesignJSON),JSON.stringify(linkLists),JSON.stringify(undo),JSON.stringify(redo),changedMenu], "*" ); } } function clearAction(){ if (window.self!==window.top) { jQuery.each(undo, function(key, item) { undoAction(); }); redo = []; /* if no mega menu present, remove theme scripts */ if (jQuery(".buddha-menu-item").length==0) { jQuery("#themeScript").remove(); } parent.postMessage(["updateToolbar",JSON.stringify(schemaDesignJSON),JSON.stringify(linkLists),JSON.stringify(undo),JSON.stringify(redo),changedMenu], "*" ); } } /* DESIGN */ /* .vertical-mega-menu li a ,.vertical-mega-menu li.fa */ var propSettings = {"background_color":{element:".horizontal-mega-menu ul.mm-submenu, .horizontal-mega-menu>li>ul.mm-submenu.tabbed>li>ul.mm-submenu li,.horizontal-mega-menu li.buddha-menu-item:hover ul.mm-submenu.simple li:hover, .horizontal-mega-menu li.buddha-menu-item.mega-hover ul.mm-submenu.simple li:hover",attribute:"background"},"background_hover_color":{element:".horizontal-mega-menu ul.mm-submenu.tree li:hover, .horizontal-mega-menu ul.mm-submenu.tree li.mega-hover, .horizontal-mega-menu ul.mm-submenu.tabbed>li.tab-opened",attribute:"background"},"text_color":{element:".horizontal-mega-menu ul.mm-submenu,.horizontal-mega-menu ul.mm-submenu li,.horizontal-mega-menu ul.mm-submenu h3",attribute:"color"},"link_color":{element:".horizontal-mega-menu ul.mm-submenu li a,.horizontal-mega-menu ul.mm-submenu li.fa",attribute:"color"},"link_hover_color":{element:".horizontal-mega-menu ul.mm-submenu.tree li:hover>a, .horizontal-mega-menu ul.mm-submenu.tree li.mega-hover>a, .horizontal-mega-menu ul.mm-submenu.tabbed>li.tab-opened>a, .horizontal-mega-menu ul.mm-submenu li a:hover, .horizontal-mega-menu ul.mm-submenu.tree li.fa:hover:before, .horizontal-mega-menu ul.mm-submenu.tree li.mega-hover.fa:before, .horizontal-mega-menu ul.mm-submenu.tabbed>li.tab-opened.fa:before",attribute:"color"},"font_size":{element:".horizontal-mega-menu ul.mm-submenu",attribute:"font-size"},"button_background_color":{element:"ul.mm-submenu li.mm-contact-column button",attribute:"background"},"button_background_hover_color":{element:"ul.mm-submenu li.mm-contact-column button:hover",attribute:"background"},"button_text_color":{element:"ul.mm-submenu li.mm-contact-column button",attribute:"color"},"button_text_hover_color":{element:"ul.mm-submenu li.mm-contact-column button:hover",attribute:"color"},"vertical_text_color":{element:".vertical-mega-menu ul.mm-submenu,.vertical-mega-menu ul.mm-submenu h3",attribute:"color"},"vertical_link_color":{element:".vertical-mega-menu ul.mm-submenu li a, .vertical-mega-menu ul.mm-submenu>li>a>.toggle-menu-btn>.fa",attribute:"color"},"vertical_link_hover_color":{element:".vertical-mega-menu ul.mm-submenu>li:hover>a, .vertical-mega-menu ul.mm-submenu.tree li:hover>a, .vertical-mega-menu ul.mm-submenu.tree li.mega-hover>a, .vertical-mega-menu ul.mm-submenu.tabbed>li.tab-opened>a, .vertical-mega-menu ul.mm-submenu li a:hover, .vertical-mega-menu ul.mm-submenu.tree li:hover>a>.toggle-menu-btn>.fa:before, .vertical-mega-menu ul.mm-submenu.tree li.hovering>a>.toggle-menu-btn>.fa:before, .vertical-mega-menu ul.mm-submenu.tree li.mega-hover>a>.toggle-menu-btn>.fa:before, .vertical-mega-menu ul.mm-submenu.tabbed>li.hovering>a>.toggle-menu-btn>.fa:before, .vertical-mega-menu ul.mm-submenu.tabbed>li:hover>a>.toggle-menu-btn>.fa:before, .vertical-mega-menu ul.mm-submenu li.hovering>a",attribute:"color"},"vertical_font_size":{element:".vertical-mega-menu ul.mm-submenu,.vertical-mega-menu ul.mm-submenu.simple>li ul.mm-product-list>li .mm-list-info",attribute:"font-size"}}; function liveDesign(setting,value) { if (window.self!==window.top) { /* jQuery(propSettings[setting].element).css(propSettings[setting].attribute,value); */ jQuery("#tempStyle").remove(); var styleSheet = '<style id="tempStyle" type="text/css">'; styleSheet += propSettings[setting].element+'{'+propSettings[setting].attribute+':'+value+' !important; }'; styleSheet += "</style>"; jQuery("head").append(styleSheet); } } var reinitAfterDesignTimeout; function updateDesign(setting,value) { if (window.self!==window.top) { jQuery("#tempStyle").remove(); item = {}; item.action = "design"; item.setting = setting; item.value = value; schemaDesignJSON.push(item); undo.push(item); /* jQuery(propSettings[setting].element).css(propSettings[setting].attribute,""); */ recreateDesign(); if (setting=="font_size") { jQuery(".horizontal-mega-menu>.buddha-menu-item>.mm-submenu").each(function(){ if (parseInt(jQuery(this).css("top"))>0) { setSubmenuBoundries(jQuery(this).parent()); } }); } clearTimeout(reinitAfterDesignTimeout); reinitAfterDesignTimeout = setTimeout(function(){reinitMenus();},100); redo = []; parent.postMessage(["updateToolbar",JSON.stringify(schemaDesignJSON),JSON.stringify(linkLists),JSON.stringify(undo),JSON.stringify(redo),changedMenu], "*" ); } } function recreateDesign() { jQuery("#previewStyle").remove(); var styleSheet = '<style id="previewStyle" type="text/css">'; jQuery.each(schemaDesignJSON, function(key, item) { if (item.action=="design" && propSettings[item.setting]!=undefined) { if (item.setting=="font_size") { fontSize = parseInt(item.value); } styleSheet += propSettings[item.setting].element+'{'+propSettings[item.setting].attribute+':'+item.value+' !important; }'; } }); styleSheet += "</style>"; jQuery("head").append(styleSheet); } function designPanelOpened() { panelOpened = true; if (jQuery("ul.mm-submenu.tabbed").length>0) { jQuery(".horizontal-mega-menu:visible>.buddha-menu-item>ul.mm-submenu.tabbed").each(function(){ jQuery(this).closest(".buddha-menu-item").addClass("mega-hover"); return false; }); } else if (jQuery("ul.mm-submenu.simple").length>0) { jQuery(".horizontal-mega-menu:visible>.buddha-menu-item>ul.mm-submenu.simple").each(function(){ jQuery(this).closest(".buddha-menu-item").addClass("mega-hover"); return false; }); } else if (jQuery("ul.mm-submenu.contact").length>0) { jQuery(".horizontal-mega-menu:visible>.buddha-menu-item>ul.mm-submenu.contact").each(function(){ jQuery(this).closest(".buddha-menu-item").addClass("mega-hover"); return false; }); } else if (jQuery("ul.mm-submenu.tree").length>0) { jQuery(".horizontal-mega-menu:visible>.buddha-menu-item>ul.mm-submenu.tree").each(function(){ jQuery(this).closest(".buddha-menu-item").addClass("mega-hover"); return false; }); } setSubmenuBoundries(jQuery(".buddha-menu-item.mega-hover")); setContactSubmenuBoundries(jQuery(".buddha-menu-item.mega-hover")); if (jQuery("ul.mm-submenu.tabbed").length>0) { setTabbedSubmenuBoundries(jQuery(".buddha-menu-item.mega-hover>ul.mm-submenu.tabbed>li:first-child")); } jQuery(".horizontal-mega-menu>.buddha-menu-item").hover(function(){ jQuery(".mega-hover").removeClass("mega-hover"); if (panelOpened) { jQuery(this).addClass("mega-hover"); } }); } function designPanelClosed() { panelOpened = false; /* jQuery(".buddha-menu-item").removeClass("disabled"); */ jQuery(".mega-hover").removeClass("mega-hover"); } window.addEventListener("message", function(event) { if (window.self!==window.top) { if (~event.origin.indexOf("buddhaapps.com")) { if (typeof event.data=="object") { if (event.data[0]=="applyMegaMenu") { window[event.data[0]](event.data[1]); } else if (jQuery.inArray(event.data[0],["undoAction","redoAction","clearAction","initSaving","designPanelOpened","designPanelClosed"])!==-1) { window[event.data[0]](); } else if (jQuery.inArray(event.data[0],["liveDesign","updateDesign"])!==-1) { window[event.data[0]](event.data[1],event.data[2]); } } else { window[event.data](); } } else { return; } } }); /* PAGE UNLOADING FUNCTIONS */ function initSaving() { saving = true; } jQuery(window).on("beforeunload", function() { if (window.self!==window.top && (undo.length>0 || changedMenu) && !saving) { return "You might have unsaved changes."; } }); jQuery(window).on("unload", function() { changingPage = true; if (window.self!==window.top) { parent.postMessage("startLoader", "*" ); } }); /* STORE FRONT FUNCTIONS */ /* used to open/close the vertical menu */ function toggleSubmenu(element) { submenuToggled = true; var submenu = jQuery(element).closest("li").find("ul.mm-submenu").first(); if (!submenu.hasClass("submenu-opened")) { jQuery(element).closest("li").addClass("hovering"); jQuery(element).find(">.fa").removeClass("fa-plus-circle").addClass("fa-minus-circle"); submenu.addClass("submenu-opened"); } else { jQuery(element).closest("li").removeClass("hovering"); jQuery(element).find(">.fa").removeClass("fa-minus-circle").addClass("fa-plus-circle"); submenu.removeClass("submenu-opened"); } setTimeout(function(){ submenuToggled = false; },100); return false; } function mmGoToPage(element) { if (!changingPage && !submenuToggled) { if (jQuery(element).attr("data-href")!="no-link") { if (jQuery(element).attr("data-href").indexOf("http")!==-1 && jQuery(element).attr("data-href").indexOf(window.location.hostname)===-1) { changingPage = true; var win = window.open(jQuery(element).attr("data-href"), "_blank"); win.focus(); setTimeout(function(){ changingPage = false; },300); } else { changingPage = true; window.location=jQuery(element).attr("data-href"); setTimeout(function(){ changingPage = false; },1000); } } } return false; } /* set the boundries of the submenus */ function setSubmenuBoundries(li) { var bodyWidth = jQuery("body").width(); var headerOffset = 1000; if (jQuery(li).find(">ul.mm-submenu.simple").length>0 || jQuery(li).find(">ul.mm-submenu.tabbed").length>0) { if (jQuery(li).closest(".horizontal-mega-menu").length>0) { /* get header offset */ /* IF YOU REMOVE .parent(). IT WILL AFFECT THE MENU FROM alex-woo-jewelry.myshopify.com */ jQuery(li).parent().parents().each(function(){ var offsetLeft = jQuery(this).offset().left+parseInt(jQuery(this).css("padding-left")); if (offsetLeft<headerOffset && offsetLeft>0) { headerOffset = offsetLeft; } }); if (headerOffset==1000 || bodyWidth<=768) { headerOffset = 0; } if (customHeaderOffset && customHeaderOffset<bodyWidth) { headerOffset = (bodyWidth-customHeaderOffset)/2; } /* set menu width */ if (jQuery(li).find(">ul.mm-submenu.simple").length>0) { var submenu = jQuery(li).find(">ul.mm-submenu.simple"); } else { var submenu = jQuery(li).find(">ul.mm-submenu.tabbed"); } submenu.css({"width":"auto","left":"auto","right":"auto"}); /*submenu.removeAttr("style"); submenu.find(">li").removeAttr("style");*/ if (headerOffset*2>bodyWidth) { headerOffset = 0; }
 var headerWidth = 700; headerOffset=(bodyWidth-headerWidth)/2; var itemsPerRow = 5; if (headerWidth>=1020) { /* submenu.attr("columns",5).css("width",headerWidth+"px"); */ var style = submenu.attr("columns",5).attr("style"); style += "width:"+headerWidth+"px !important;"; submenu.attr("style",style); itemsPerRow = 5; } else if (headerWidth>=816) { var style = submenu.attr("columns",4).attr("style"); style += "width:"+headerWidth+"px !important;"; submenu.attr("style",style); itemsPerRow = 4; } else if (headerWidth>=612) { var style = submenu.attr("columns",3).attr("style"); style += "width:"+headerWidth+"px !important;"; submenu.attr("style",style); itemsPerRow = 3; } else { var style = submenu.attr("columns",2).attr("style"); style += "width:"+headerWidth+"px !important;"; submenu.attr("style",style); itemsPerRow = 2; } if (jQuery(li).find(">ul.mm-submenu.tabbed").length>0) { --itemsPerRow; } /* set simple submenu boundry */ var offsetLeft = jQuery(li).offset().left+jQuery(li).outerWidth()/2; if (offsetLeft<(bodyWidth/2)) { var left = bodyWidth-(bodyWidth-jQuery(li).offset().left)-headerOffset; submenu.css("left",-left+"px"); } else { var right = bodyWidth-jQuery(li).offset().left-jQuery(li).outerWidth()-headerOffset; submenu.css("right",-right+"px"); } /* set min height for each element */ jQuery(li).find("ul.mm-submenu.simple>li").removeAttr("style"); jQuery(li).find(".mm-list-name").removeAttr("style"); /* if simple menu */ if (jQuery(li).find(">ul.mm-submenu.simple").length>0) { var rowMinHeight = 0; var mmListNameHeight = 0; jQuery(li).find("ul.mm-submenu.simple>li").each(function(i, item){ if (i%itemsPerRow==0) { rowMinHeight = 0; mmListNameHeight = 0; } if (jQuery(this).find(".mm-list-name").length>0) { if (jQuery(this).find(".mm-list-name").height()>mmListNameHeight) { mmListNameHeight = jQuery(this).find(".mm-list-name").height(); jQuery(this).find(".mm-list-name").css("height",mmListNameHeight); var previousItems = i; if (previousItems%itemsPerRow!=0) { while (previousItems%itemsPerRow!=0) { jQuery(li).find("ul.mm-submenu.simple").find(">li:nth-child("+previousItems+")").find(".mm-list-name").css("height",mmListNameHeight); previousItems--; } } } else { jQuery(this).find(".mm-list-name").css("height",mmListNameHeight); } } if (jQuery(this).outerHeight()>rowMinHeight) { rowMinHeight = jQuery(this).outerHeight()+2; jQuery(this).css("min-height",rowMinHeight); var previousItems = i; if (previousItems%itemsPerRow!=0) { while (previousItems%itemsPerRow!=0) { jQuery(li).find("ul.mm-submenu.simple").find(">li:nth-child("+previousItems+")").css("min-height",rowMinHeight); previousItems--; } } } else { jQuery(this).css("min-height",rowMinHeight); } }); /* if tabbed menu */ } else { jQuery(li).find("ul.mm-submenu.tabbed>li").each(function(i,tab){ var rowMinHeight = 0; var mmListNameHeight = 0; jQuery(tab).find("ul.mm-submenu.simple>li").each(function(j, item){ if (j%itemsPerRow==0) { rowMinHeight = 0; mmListNameHeight = 0; } if (jQuery(this).find(".mm-list-name").length>0) { if (jQuery(this).find(".mm-list-name").height()>mmListNameHeight) { mmListNameHeight = jQuery(this).find(".mm-list-name").height(); jQuery(this).find(".mm-list-name").css("height",mmListNameHeight); var previousItems = j; if (previousItems%itemsPerRow!=0) { while (previousItems%itemsPerRow!=0) { jQuery(this).parent().find(">li:nth-child("+previousItems+")").find(".mm-list-name").css("height",mmListNameHeight); previousItems--; } } } else { jQuery(this).find(".mm-list-name").css("height",mmListNameHeight); } } if (jQuery(this).outerHeight()>rowMinHeight) { if (fontSize<=14) { fontSize = 6; } else if (fontSize>14 && fontSize<=18) { fontSize += 2; } else if (fontSize>18 && fontSize<=20) { fontSize += 6; } rowMinHeight = jQuery(this).outerHeight()+fontSize; jQuery(this).css("min-height",rowMinHeight); var previousItems = j; if (previousItems%itemsPerRow!=0) { while (previousItems%itemsPerRow!=0) { jQuery(li).find("ul.mm-submenu.simple").find(">li:nth-child("+previousItems+")").css("min-height",rowMinHeight); previousItems--; } } } else { jQuery(this).css("min-height",rowMinHeight); } }); }); /* add arrows */ jQuery(li).find("ul.mm-submenu.tabbed>li").addClass("fa fa-angle-right"); } } else { jQuery(li).find("ul.mm-submenu.tabbed").css({"left":"auto","right":"auto"}); var currentStyle = jQuery(li).find("ul.mm-submenu.tabbed").attr("style"); var newStyle = ""; if (currentStyle!=undefined) { newStyle += currentStyle+";height:auto !important;width:auto !important"; } else { newStyle += "height:auto !important;width:auto !important"; } jQuery(li).find("ul.mm-submenu.tabbed").attr("style",newStyle); jQuery(li).find("ul.mm-submenu.simple").css({"left":"auto","right":"auto"}); var currentStyle = jQuery(li).find("ul.mm-submenu.simple").attr("style"); var newStyle = ""; if (currentStyle!=undefined) { newStyle += currentStyle+";width:auto !important"; } else { newStyle += ";width:auto !important"; } jQuery(li).find("ul.mm-submenu.simple").attr("style",newStyle); jQuery(li).find("ul.mm-submenu.simple>li").removeAttr("style"); if (jQuery(li).width()>=700) { jQuery(li).find("ul.mm-submenu.simple").attr("columns",3); jQuery(".vertical-mega-menu ul.mm-submenu.mm-contact").attr("columns",2); } else if (jQuery(li).width()>=500) { jQuery(li).find("ul.mm-submenu.simple").attr("columns",2); jQuery(".vertical-mega-menu ul.mm-submenu.mm-contact").attr("columns",2); } else { jQuery(li).find("ul.mm-submenu.simple").removeAttr("columns"); jQuery(".vertical-mega-menu ul.mm-submenu.mm-contact").removeAttr("columns"); } } } else if (jQuery(li).find("ul.mm-submenu.tree").length>0) { jQuery(li).find("ul.mm-submenu").removeAttr("style"); var offsetLeft = jQuery(li).offset().left+jQuery(li).outerWidth()/2; if (offsetLeft<(bodyWidth/2)) { jQuery(li).find("ul.mm-submenu").removeClass("tree-open-left"); jQuery(li).find("ul.mm-submenu.tree li").removeClass("fa fa-angle-right fa-angle-left"); jQuery(li).find("ul.mm-submenu.tree li").each(function(){ if (jQuery(this).find("ul.mm-submenu").length>0) { jQuery(this).addClass("fa fa-angle-right"); } }); } else { jQuery(li).find("ul.mm-submenu").addClass("tree-open-left"); jQuery(li).find("ul.mm-submenu.tree li").removeClass("fa fa-angle-right fa-angle-left"); jQuery(li).find("ul.mm-submenu.tree li").each(function(){ if (jQuery(this).find("ul.mm-submenu").length>0) { jQuery(this).addClass("fa fa-angle-left"); } }); } } } /* when you hover over the tabs of the tabbed submenu, open their submenu + readjust the height of the tabbed submenu */ function setTabbedSubmenuBoundries(li) { if (jQuery(li).closest(".horizontal-mega-menu").length>0) { /* reset the boundries of the simple submenu, because it wasn"t visible before */ setSubmenuBoundries(jQuery(li).closest(".buddha-menu-item")); /* set the tabbed submenu height */ var currentLi = jQuery(li).parent().find(">li").index(jQuery(li)); if (jQuery(li).find(">ul.mm-submenu").length>0) { jQuery(li).find(">ul.mm-submenu").removeAttr("style"); var tabbedSubmenuHeight = jQuery(li).find(">ul.mm-submenu").outerHeight(); var tabsHeight = 0; jQuery(li).parent().find(">li").each(function(){ tabsHeight += jQuery(this).outerHeight(); }); if (tabsHeight>tabbedSubmenuHeight) { /* jQuery(li).parent().css("height",tabsHeight+"px"); */ var currentStyle = jQuery(li).parent().attr("style"); var newStyle = ""; if (currentStyle!=undefined) { newStyle += currentStyle+";height:"+tabsHeight+"px !important"; } else { newStyle += "height:"+tabsHeight+"px !important"; } jQuery(li).parent().attr("style",newStyle); /* jQuery(li).find(">ul.mm-submenu").css("height",tabsHeight+"px"); */ var currentStyle = jQuery(li).find(">ul.mm-submenu").attr("style"); var newStyle = ""; if (currentStyle!=undefined) { newStyle += currentStyle+";height:"+tabsHeight+"px !important"; } else { newStyle += "height:"+tabsHeight+"px !important"; } jQuery(li).find(">ul.mm-submenu").attr("style",newStyle); } else { /* jQuery(li).parent().css("height",tabbedSubmenuHeight+"px"); */ var currentStyle = jQuery(li).parent().attr("style"); var newStyle = ""; if (currentStyle!=undefined) { newStyle += currentStyle+";height:"+tabbedSubmenuHeight+"px !important"; } else { newStyle += "height:"+tabbedSubmenuHeight+"px !important"; } jQuery(li).parent().attr("style",newStyle); } } else { jQuery(li).parent().css("height","auto"); } /* set the simple submenu top */ var top = jQuery(li).parent().find(">li:nth-child("+(currentLi+1)+")").position().top; var currentStyle = jQuery(li).find(">ul.mm-submenu").attr("style"); var newStyle = ""; if (currentStyle!=undefined) { newStyle += currentStyle+";top:-"+top+"px !important"; } else { newStyle += "top:-"+top+"px !important"; } jQuery(li).find(">ul.mm-submenu").attr("style",newStyle); } else { jQuery(li).closest(".vertical-mega-menu").find(".tab-opened").removeClass("tab-opened"); /* jQuery(".tab-opened").removeClass("tab-opened"); */ } } /* set the boundries of the contact submenus */ function setContactSubmenuBoundries(li) { var bodyWidth = jQuery("body").width(); var headerOffset = 1000; if (jQuery(li).find(">ul.mm-submenu.mm-contact").length>0 && jQuery(li).closest(".horizontal-mega-menu").length>0) { /* get header offset */ jQuery(li).parent().parents().each(function(){ var offsetLeft = jQuery(this).offset().left+parseInt(jQuery(this).css("padding-left")); if (offsetLeft<headerOffset && offsetLeft>0) { headerOffset = offsetLeft; } }); if (headerOffset==1000) { headerOffset = 0; } if (headerOffset*2>bodyWidth) { headerOffset = 0; } /* set menu width */ var submenu = jQuery(li).find(">ul.mm-submenu.mm-contact"); var headerWidth = bodyWidth-headerOffset*2; submenu.css({"width":headerWidth+"px","left":"auto","right":"auto"}); /* set simple submenu boundry */ var offsetLeft = jQuery(li).offset().left+jQuery(li).outerWidth()/2; if (offsetLeft<(bodyWidth/2)) { var left = bodyWidth-(bodyWidth-jQuery(li).offset().left)-headerOffset; submenu.css("left",-left+"px"); } else { var right = bodyWidth-jQuery(li).offset().left-jQuery(li).outerWidth()-headerOffset; submenu.css("right",-right+"px"); } } else { jQuery(li).find("ul.mm-submenu.mm-contact").css({"left":"auto","right":"auto","width":"auto","height":"auto"}); if (jQuery(li).find(">ul.mm-submenu.mm-contact").width()<=480) { jQuery(li).find(">ul.mm-submenu.mm-contact").addClass("one-column"); } } } function addTouch() { /* jQuery(".vertical-mega-menu>li.buddha-menu-item").off(); jQuery(".horizontal-mega-menu>li.buddha-menu-item").off(); */ /* when touching outside close the submenu */ touched = false; if (globalTouch) { jQuery("*").off("touchend.mm-all-dom-elements"); jQuery("*").on("touchend.mm-all-dom-elements", function (e) { if (jQuery(this).closest(".buddha-menu-item").length==0) { jQuery(".mega-hover").removeClass("mega-hover"); } /* var element = jQuery(this); if (!clicked && !touched) { touched = true; setTimeout(function(){ if (!changingPage && element.closest(".buddha-menu-item").length==0 && !element.hasClass("vertical-mega-menu") && !element.hasClass("horizontal-mega-menu")) { applyMegaMenu(); } },100); setTimeout(function(){ if (!changingPage && element.closest(".buddha-menu-item").length==0 && !element.hasClass("vertical-mega-menu") && !element.hasClass("horizontal-mega-menu")) { applyMegaMenu(); } },350); } setTimeout(function(){ touched = false; },400); */ }); } jQuery(".horizontal-mega-menu>li.buddha-menu-item").off("touchend.mm-horizontal-li"); jQuery(".horizontal-mega-menu>li.buddha-menu-item").on("touchend.mm-horizontal-li", function (e) { "use strict"; var li = jQuery(this); if (li.find("ul.mm-submenu").length>0) { if (li.hasClass("mega-hover")) { return true; } else { e.preventDefault(); jQuery(".mega-hover").removeClass("mega-hover"); li.addClass("mega-hover"); setSubmenuBoundries(li); return false; } } else { return true; } }); var elementTouched = false; jQuery(".vertical-mega-menu li").off("touchstart.mm-vertical-li"); jQuery(".vertical-mega-menu li").on("touchstart.mm-vertical-li", function (e) { elementTouched = false; }); jQuery(".vertical-mega-menu li").off("touchmove.mm-vertical-li"); jQuery(".vertical-mega-menu li").on("touchmove.mm-vertical-li", function (e) { elementTouched = true; }); jQuery(".vertical-mega-menu li").off("touchend.mm-vertical-li"); jQuery(".vertical-mega-menu li").on("touchend.mm-vertical-li", function (e) { "use strict"; if (!elementTouched) { elementTouched = true; setTimeout(function(){ elementTouched = false; },300); var li = jQuery(this); if (li.find("ul.mm-submenu").length>0) { if (li.hasClass("hovering")) { return true; } else { e.preventDefault(); if (li.find(">a>.toggle-menu-btn").length>0) { li.find(">a>.toggle-menu-btn").click(); } else if (li.find(">a>span>.toggle-menu-btn").length>0) { li.find(">a>span>.toggle-menu-btn").click(); } return false; } } else { setTimeout(function(){ if (!changingPage) { li.find("a").first().click(); } },200); return true; } } }); jQuery(".horizontal-mega-menu>li.buddha-menu-item>ul.mm-submenu.tabbed>li").off("touchend.mm-tab"); jQuery(".horizontal-mega-menu>li.buddha-menu-item>ul.mm-submenu.tabbed>li").on("touchend.mm-tab", function (e) { "use strict"; var li = jQuery(this); if (li.find("ul.mm-submenu").length>0) { if (li.hasClass("tab-opened")) { return true; } else { e.preventDefault(); li.parent().find(">li").removeClass("tab-opened"); li.addClass("tab-opened"); setTabbedSubmenuBoundries(li); setSubmenuBoundries(li.parent().parent()); return false; } } else { return true; } }); jQuery(".horizontal-mega-menu>li.buddha-menu-item>ul.mm-submenu.tree li").off("touchend.mm-tree"); jQuery(".horizontal-mega-menu>li.buddha-menu-item>ul.mm-submenu.tree li").on("touchend.mm-tree", function (e) { "use strict"; var li = jQuery(this); if (li.find("ul.mm-submenu").length>0) { if (li.hasClass("mega-hover")) { return true; } else { e.preventDefault(); li.parent().find(">li").removeClass("mega-hover"); li.addClass("mega-hover"); li.find(".mega-hover").removeClass("mega-hover"); jQuery.each(li.parents(),function(){ if (jQuery(this).prop("tagName").toLowerCase()=="li") { jQuery(this).addClass("mega-hover"); } }); setSubmenuBoundries(li); return false; } } else { return true; } }); } function getUlPath(element) { var path, node = element; var firstNode = true; while (node.length) { var realNode = node[0], name = realNode.localName; if (!name) break; name = name.toLowerCase(); var parent = node.parent(); var nthChild = ""; var sameTagSiblings = parent.children(name); if (sameTagSiblings.length > 1) { allSiblings = parent.children(); var index = allSiblings.index(realNode) + 1; if (index > 0) { nthChild = ":nth-child(" + index + ")"; } } var idClass = ""; ignoreClass = false; if (name!="body" && name!="html") { if(jQuery(realNode).prop("id").length > 0) { idClass = "#"+realNode.id; } else if (jQuery(realNode).prop("class").length > 0 && !firstNode && !ignoreClass) { /* idClass = "."+realNode.className.trim().replace(/ /g, ".").replace(".is-light", "").replace(".is-dark", "").replace(".is-complete", "").replace(".is-processing", "").replace("..",".").replace("..",".").replace("..",".").replace("..",".").replace("..","."); idClass = idClass.replace(".DomOutlineBox", "").replace(".vertical-mega-menu", "").replace(".horizontal-mega-menu", ""); */ if (jQuery(realNode).attr("class")!=undefined && jQuery(realNode).attr("class").trim()!="") { idClass = "."+jQuery(realNode).attr("class").trim().split(" ")[0]; } } } if (jQuery.inArray(name,["li","ul","header"])!==-1) { name += nthChild; } /* name += nthChild; */ firstNode = false; path = name + idClass + (path ? ">" + path : ""); node = parent; } return path; } } </script>